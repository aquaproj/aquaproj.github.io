"use strict";(self.webpackChunkaqua_docusaurus=self.webpackChunkaqua_docusaurus||[]).push([[6101],{5680:(e,a,n)=>{n.d(a,{xA:()=>u,yg:()=>y});var t=n(6540);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function s(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?s(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function p(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=t.createContext({}),l=function(e){var a=t.useContext(o),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},u=function(e){var a=l(e.components);return t.createElement(o.Provider,{value:a},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},c=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),g=l(n),c=r,y=g["".concat(o,".").concat(c)]||g[c]||d[c]||s;return n?t.createElement(y,i(i({ref:a},u),{},{components:n})):t.createElement(y,i({ref:a},u))}));function y(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=c;var p={};for(var o in a)hasOwnProperty.call(a,o)&&(p[o]=a[o]);p.originalType=e,p[g]="string"==typeof e?e:r,i[1]=p;for(var l=2;l<s;l++)i[l]=n[l];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3337:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>p,toc:()=>l});var t=n(8168),r=(n(6540),n(5680));const s={sidebar_position:300},i="Update registries and packages by update command",p={unversionedId:"guides/update-command",id:"guides/update-command",title:"Update registries and packages by update command",description:"You can update them by Renovate too.",source:"@site/docs/guides/update-command.md",sourceDirName:"guides",slug:"/guides/update-command",permalink:"/docs/guides/update-command",draft:!1,editUrl:"https://github.com/aquaproj/aquaproj.github.io/edit/main/docs/guides/update-command.md",tags:[],version:"current",sidebarPosition:300,frontMatter:{sidebar_position:300},sidebar:"tutorialSidebar",previous:{title:"Split the list of packages",permalink:"/docs/guides/split-config"},next:{title:"Install private packages",permalink:"/docs/guides/private-package"}},o={},l=[{value:"Updated configuration file paths",id:"updated-configuration-file-paths",level:2},{value:"Update only registries",id:"update-only-registries",level:2},{value:"Update only packages",id:"update-only-packages",level:2},{value:"Update only specific commands",id:"update-only-specific-commands",level:2},{value:"Specify versions",id:"specify-versions",level:2},{value:"Select packages with Fuzzy Finder",id:"select-packages-with-fuzzy-finder",level:2},{value:"Select the package version with Fuzzy Finder",id:"select-the-package-version-with-fuzzy-finder",level:2},{value:"The field <code>version</code> is ignored",id:"the-field-version-is-ignored",level:2},{value:"commit hashes are ignored",id:"commit-hashes-are-ignored",level:2},{value:"Exclude some packages from the target of <code>aqua update</code>",id:"exclude-some-packages-from-the-target-of-aqua-update",level:2},{value:"Known Issues",id:"known-issues",level:2},{value:"<code>null</code> is set to <code>packages</code> wrongly if registries are updated and <code>packages</code> is empty",id:"null-is-set-to-packages-wrongly-if-registries-are-updated-and-packages-is-empty",level:3},{value:"Newlines are removed wrongly",id:"newlines-are-removed-wrongly",level:3}],u={toc:l},g="wrapper";function d(e){let{components:a,...n}=e;return(0,r.yg)(g,(0,t.A)({},u,n,{components:a,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"update-registries-and-packages-by-update-command"},"Update registries and packages by update command"),(0,r.yg)("admonition",{type:"info"},(0,r.yg)("p",{parentName:"admonition"},"You can update them by Renovate too.\nPlease see ",(0,r.yg)("a",{parentName:"p",href:"/docs/guides/renovate"},"Update packages by Renovate")," too.")),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/aquaproj/aqua/issues/1657"},"#1657")," ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/aquaproj/aqua/pull/2329"},"#2329")," aqua >= ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/aquaproj/aqua/releases/tag/v2.14.0"},"v2.14.0")),(0,r.yg)("p",null,"You can update registries and packages by ",(0,r.yg)("inlineCode",{parentName:"p"},"aqua update (up)")," command."),(0,r.yg)("p",null,"If no argument is passed, all registries and packages are updated to the latest."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Update all packages and registries to the latest versions\naqua update\n")),(0,r.yg)("p",null,'This command has an alias "up"'),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"aqua up\n")),(0,r.yg)("p",null,"This command"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"gets the latest version from GitHub Releases, GitHub Tags, and crates.io and updates aqua.yaml"),(0,r.yg)("li",{parentName:"ul"},"doesn't install packages")),(0,r.yg)("h2",{id:"updated-configuration-file-paths"},"Updated configuration file paths"),(0,r.yg)("p",null,"This command finds a configuration file ",(0,r.yg)("inlineCode",{parentName:"p"},"aqua.yaml")," according to ",(0,r.yg)("a",{parentName:"p",href:"/docs/reference/config/#configuration-file-path"},"the rule")," and updates only one file.\nOnce this command finds one file, it stops searching other aqua.yaml."),(0,r.yg)("p",null,"So if you want to update other files, please change the current directory or specify the configuration file path with the option ",(0,r.yg)("inlineCode",{parentName:"p"},"-c"),"."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"aqua -c foo/aqua.yaml update\n")),(0,r.yg)("h2",{id:"update-only-registries"},"Update only registries"),(0,r.yg)("p",null,"If you want to update only registries, please use the ",(0,r.yg)("inlineCode",{parentName:"p"},"--only-registry [-r]")," option."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Update only registries\naqua update -r\n")),(0,r.yg)("h2",{id:"update-only-packages"},"Update only packages"),(0,r.yg)("p",null,"If you want to update only packages, please use the ",(0,r.yg)("inlineCode",{parentName:"p"},"--only-package [-p]")," option."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Update only packages\naqua update -p\n")),(0,r.yg)("h2",{id:"update-only-specific-commands"},"Update only specific commands"),(0,r.yg)("p",null,"You can specify packages with command names. aqua finds packages that have these commands and updates them."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"aqua update <command name> [<command name> ...]\n")),(0,r.yg)("p",null,"e.g."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Update cli/cli\naqua update gh\n")),(0,r.yg)("h2",{id:"specify-versions"},"Specify versions"),(0,r.yg)("p",null,"You can specify versions."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"aqua update gh@v2.30.0\n")),(0,r.yg)("h2",{id:"select-packages-with-fuzzy-finder"},"Select packages with Fuzzy Finder"),(0,r.yg)("p",null,"If you want to update only specific packages, please use the ",(0,r.yg)("inlineCode",{parentName:"p"},"-i")," option.\nYou can select packages with the fuzzy finder.\nIf ",(0,r.yg)("inlineCode",{parentName:"p"},"-i")," option is used, registries aren't updated."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Select updated packages with fuzzy finder\naqua update -i\n")),(0,r.yg)("h2",{id:"select-the-package-version-with-fuzzy-finder"},"Select the package version with Fuzzy Finder"),(0,r.yg)("p",null,"If you want to select versions, please use the ",(0,r.yg)("inlineCode",{parentName:"p"},"-s")," option.\nYou can select versions with the fuzzy finder. You can not only update but also downgrade packages."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"# Select updated packages and versions with fuzzy finder\naqua update -i -s\n")),(0,r.yg)("h2",{id:"the-field-version-is-ignored"},"The field ",(0,r.yg)("inlineCode",{parentName:"h2"},"version")," is ignored"),(0,r.yg)("p",null,"This command doesn't update packages if the ",(0,r.yg)("inlineCode",{parentName:"p"},"version")," field is used."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"packages:\n  - name: cli/cli@v2.0.0 # Update\n  - name: gohugoio/hugo\n    version: v0.118.0 # Doesn't update\n")),(0,r.yg)("p",null,"So if you don't want to update specific packages, the ",(0,r.yg)("inlineCode",{parentName:"p"},"version")," field is useful."),(0,r.yg)("h2",{id:"commit-hashes-are-ignored"},"commit hashes are ignored"),(0,r.yg)("p",null,"This command doesn't update commit hashes."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"packages:\n  - name: google/pprof@d04f2422c8a17569c14e84da0fae252d9529826b # Doesn't update\n")),(0,r.yg)("h2",{id:"exclude-some-packages-from-the-target-of-aqua-update"},"Exclude some packages from the target of ",(0,r.yg)("inlineCode",{parentName:"h2"},"aqua update")),(0,r.yg)("p",null,"aqua >= ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/aquaproj/aqua/releases/tag/v2.25.0"},"v2.25.0")," ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/orgs/aquaproj/discussions/2749#discussioncomment-8808062"},"#2749")," ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/aquaproj/aqua/pull/2752"},"#2752")),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"aqua update")," updates all packages by default, but you may not want to update some packages.\nIn this case, you can exclude some packages from the target of ",(0,r.yg)("inlineCode",{parentName:"p"},"aqua update"),"."),(0,r.yg)("p",null,"e.g. aqua.yaml"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"packages:\n- name: golang/vuln/govulncheck@v1.0.3\n  update:\n    # If enabled is false, aqua up command ignores the package.\n    # If the package name is passed to aqua up command explicitly, enabled is ignored.\n    # By default, enabled is true.\n    enabled: false\n")),(0,r.yg)("p",null,"If you specify the package explicitly, the setting ",(0,r.yg)("inlineCode",{parentName:"p"},"enabled")," is ignored."),(0,r.yg)("p",null,"e.g."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-console"},"$ aqua up govuluncheck # the package is updated even if update.enabled is false\n")),(0,r.yg)("h2",{id:"known-issues"},"Known Issues"),(0,r.yg)("p",null,"There are some known issues related to the third party library ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/goccy/go-yaml"},"goccy/go-yaml"),"."),(0,r.yg)("h3",{id:"null-is-set-to-packages-wrongly-if-registries-are-updated-and-packages-is-empty"},(0,r.yg)("inlineCode",{parentName:"h3"},"null")," is set to ",(0,r.yg)("inlineCode",{parentName:"h3"},"packages")," wrongly if registries are updated and ",(0,r.yg)("inlineCode",{parentName:"h3"},"packages")," is empty"),(0,r.yg)("p",null,"This issue is because of the third party library ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/goccy/go-yaml"},"goccy/go-yaml"),"."),(0,r.yg)("p",null,"Before"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"registries:\n- ref: v4.155.0\n  type: standard\npackages:\n")),(0,r.yg)("p",null,"Run ",(0,r.yg)("inlineCode",{parentName:"p"},"aqua up"),"."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-console"},"$ aqua up\nINFO[0000] updating a registry                           aqua_version= env=darwin/arm64 new_version=v4.155.1 old_version=v4.155.0 program=aqua registry_name=standard\n")),(0,r.yg)("p",null,"After"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"registries:\n- ref: v4.155.1\n  type: standard\npackages: null\n")),(0,r.yg)("h3",{id:"newlines-are-removed-wrongly"},"Newlines are removed wrongly"),(0,r.yg)("p",null,"This issue is because of the third party library ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/goccy/go-yaml"},"goccy/go-yaml"),"."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("a",{parentName:"li",href:"https://github.com/goccy/go-yaml/issues/285"},"https://github.com/goccy/go-yaml/issues/285"))),(0,r.yg)("p",null,"Before"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"registries:\n- ref: v4.155.0\n  type: standard\n\n\npackages:\n- name: suzuki-shunsuke/mkghtag@v0.1.1\n")),(0,r.yg)("p",null,"Run ",(0,r.yg)("inlineCode",{parentName:"p"},"aqua up"),"."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-console"},"$ aqua up\nINFO[0000] updating a registry                           aqua_version= env=darwin/arm64 new_version=v4.155.1 old_version=v4.155.0 program=aqua registry_name=standard\n")),(0,r.yg)("p",null,"After"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"registries:\n- ref: v4.155.1\n  type: standard\npackages:\n- name: suzuki-shunsuke/mkghtag@v0.1.1\n")))}d.isMDXComponent=!0}}]);